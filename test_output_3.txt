
> wine-tracker@1.0.7 test
> jest __tests__/integration/process-image.test.ts --testTimeout=60000

  console.log
    [dotenv@17.2.0] injecting env (1) from .env.local (tip: ðŸ” encrypt with dotenvx: https://dotenvx.com)

      at _log (node_modules/dotenv/lib/main.js:136:11)

  console.log
    [dotenv@17.2.0] injecting env (0) from .env (tip: ðŸ” prevent building .env in docker: https://dotenvx.com/prebuild)

      at _log (node_modules/dotenv/lib/main.js:136:11)

FAIL __tests__/integration/process-image.test.ts (240.489 s)
  Process Image API with Blob URLs
    Ã— should process image from Vercel Blob URL (60017 ms)
    Ã— should handle both file upload and URL processing (60009 ms)
    Ã— should validate image URL format (60010 ms)
    Ã— should handle missing imageUrl when no file provided (60001 ms)

  â— Process Image API with Blob URLs â€º should process image from Vercel Blob URL

    thrown: "Exceeded timeout of 60000 ms for a test.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 17 |[39m     refineWineDataWithGemini[33m:[39m jest[33m.[39mfn()[33m,[39m
     [90m 18 |[39m   }))[33m;[39m
    [31m[1m>[22m[39m[90m 19 |[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 20 |[39m   [36mconst[39m mockFetch [33m=[39m jest[33m.[39mfn()[33m;[39m
     [90m 21 |[39m   global[33m.[39mfetch [33m=[39m mockFetch[33m;[39m
     [90m 22 |[39m[0m

      at it (__tests__/integration/process-image.test.ts:19:3)
      at Object.describe (__tests__/integration/process-image.test.ts:3:1)

  â— Process Image API with Blob URLs â€º should handle both file upload and URL processing

    thrown: "Exceeded timeout of 60000 ms for a test.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 57 |[39m     expect(res[33m.[39m_getStatusCode())[33m.[39mtoBe([35m200[39m)[33m;[39m
     [90m 58 |[39m     [36mconst[39m response [33m=[39m [33mJSON[39m[33m.[39mparse(res[33m.[39m_getData())[33m;[39m
    [31m[1m>[22m[39m[90m 59 |[39m
     [90m    |[39m [31m[1m^[22m[39m
     [90m 60 |[39m     expect(response)[33m.[39mtoMatchObject({
     [90m 61 |[39m       success[33m:[39m [36mtrue[39m[33m,[39m
     [90m 62 |[39m       data[33m:[39m {[0m

      at it (__tests__/integration/process-image.test.ts:59:3)
      at Object.describe (__tests__/integration/process-image.test.ts:3:1)

  â— Process Image API with Blob URLs â€º should validate image URL format

    thrown: "Exceeded timeout of 60000 ms for a test.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 86 |[39m     mockFetch[33m.[39mmockResolvedValue({
     [90m 87 |[39m       ok[33m:[39m [36mtrue[39m[33m,[39m
    [31m[1m>[22m[39m[90m 88 |[39m       headers[33m:[39m { [36mget[39m[33m:[39m () [33m=>[39m [32m'image/jpeg'[39m }[33m,[39m
     [90m    |[39m   [31m[1m^[22m[39m
     [90m 89 |[39m       arrayBuffer[33m:[39m [36masync[39m () [33m=>[39m [36mnew[39m [33mArrayBuffer[39m([35m10[39m)
     [90m 90 |[39m     })[33m;[39m
     [90m 91 |[39m[0m

      at it (__tests__/integration/process-image.test.ts:88:3)
      at Object.describe (__tests__/integration/process-image.test.ts:3:1)

  â— Process Image API with Blob URLs â€º should handle missing imageUrl when no file provided

    thrown: "Exceeded timeout of 60000 ms for a test.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."

    [0m [90m 107 |[39m         imageUrl[33m:[39m [32m'not-a-valid-url'[39m[33m,[39m
     [90m 108 |[39m         type[33m:[39m [32m'wine_label'[39m
    [31m[1m>[22m[39m[90m 109 |[39m       }
     [90m     |[39m   [31m[1m^[22m[39m
     [90m 110 |[39m     })[33m;[39m
     [90m 111 |[39m
     [90m 112 |[39m     [36mawait[39m handler[33m.[39m[36mdefault[39m(req [36mas[39m any[33m,[39m res [36mas[39m any)[33m;[39m[0m

      at it (__tests__/integration/process-image.test.ts:109:3)
      at Object.describe (__tests__/integration/process-image.test.ts:3:1)

Test Suites: 1 failed, 1 total
Tests:       4 failed, 4 total
Snapshots:   0 total
Time:        241.107 s
Ran all test suites matching /__tests__\\integration\\process-image.test.ts/i.
